---
layout: post
title: "Playing with Depth"
categories: 
tags: 
---

## Making files with Depths 5x, 10x, 15x, 20x, 25x, and 30x

After first filtering for a file that only kept variants that have been successfully genotyped in 50% of individuals, a minimum quality score of 30, and a minor allele count of 3.
the file brevolium_snps_biallelic_mac3_miss50.recode.vcf can be further filtered based on depth level.

# Depth is the mount of times the program reads through the file
depth is a tradeoff between the amount of data and the accuracy.
The higher the depth the more accurate it is, however the more SNPs that get filtered out because of lower Depth
I will be playing with different depth levels (5x, 10x, 15x, 20x, 25x, and 30x) to see which has the optimal amount of data vs accuracy.


# 10x
first I tried with 10x
    vcftools --gzvcf  brevolium_snps_biallelic_mac3_miss50.recode.vcf --min-meanDP 10 --recode --recode-INFO-all --out brevolium_snps_biallelic_mac3_miss50_10x

After filtering, kept 23123| out of a possible 163858 Sites


# 5x
    vcftools --gzvcf  brevolium_snps_biallelic_mac3_miss50.recode.vcf --min-meanDP 5 --recode --recode-INFO-all --out brevolium_snps_biallelic_mac3_miss50_5x

After filtering, kept 58462| out of a possible 163858 Sites


# 15x
    vcftools --gzvcf  brevolium_snps_biallelic_mac3_miss50.recode.vcf --min-meanDP 15 --recode --recode-INFO-all --out brevolium_snps_biallelic_mac3_miss50_15x

After filtering, kept 13240| out of a possible 163858 Sites


# 20x
    vcftools --gzvcf  brevolium_snps_biallelic_mac3_miss50.recode.vcf --min-meanDP 20 --recode --recode-INFO-all --out brevolium_snps_biallelic_mac3_miss50_20x

After filtering, kept 9134| out of a possible 163858 Sites


# 25x
    vcftools --gzvcf  brevolium_snps_biallelic_mac3_miss50.recode.vcf --min-meanDP 25 --recode --recode-INFO-all --out brevolium_snps_biallelic_mac3_miss50_25x

After filtering, kept 6743| out of a possible 163858 Sites


# 30x
    vcftools --gzvcf  brevolium_snps_biallelic_mac3_miss50.recode.vcf --min-meanDP 30 --recode --recode-INFO-all --out brevolium_snps_biallelic_mac3_miss50_30x

After filtering, kept 5330 out of a possible 163858 Sites

Here is a table relating the Accuracy to the amount of data

| **Depth** | **# of Sites** |
| 5x | 58462| |
| 10x | 23123| |
| 15x | 13240| |
| 20x | 9134| |
| 25x | 6743| |
| 30x | 5330 |

This table shows that as the accuracy (Depth) increases the amount of sites able to be used for analysis decreases



I can then look at how much missing information is in each of the different depths

# 5x 
    vcftools --vcf brevolium_snps_biallelic_mac3_miss50_5x.recode.vcf  --out brevolium_snps_biallelic_mac3_miss50_5x --missing-indv

cat brevolium_snps_biallelic_mac3_miss50_5x.imiss 

|INDV  | N_DATA|	N_GENOTYPES_FILTERED|	N_MISS|	F_MISS|
|S90|	58462|	0|	2697	|   0.0461325|
|S80|	58462|	0|	8879	|   0.151876|
|S71|	58462|	0|	2216	|   0.037905|
|S65|	58462|	0|	2063	|   0.0352879|
|S62|	58462|	0|	2773	|   0.0474325|
|S87|	58462|	0|	3448	|   0.0589785|
|S56|	58462|	0|	2511	|   0.042951|
|S52|	58462|	0|	2177	|   0.0372379|
|S35|	58462|	0|	18352|   	0.313913|
|S40|	58462|	0|	3236	|   0.0553522|
|S25|	58462|	0|	14828|   	0.253635|
|S19|	58462|	0|	2451	|   0.0419247|
|S14|	58462|	0|	29194|   	0.499367|
|S13|	58462|	0|	1983	|   0.0339195|
|S12|	58462|	0|	913	 |      0.015617|
|S89|	58462|	0|	829	 |      0.0141802|
|S22|	58462|	0|	3830	|   0.0655126|
|S07|	58462|	0|	3255	|   0.0556772|
|D24|	58462|	0|	14489|   	0.247836|
|D38|	58462|	0|	1008	|   0.017242|
|D87|	58462|	0|	516	 |      0.00882625|
|D18|	58462|	0|	538	 |      0.00920256|
|S75|	58462|	0|	1939	|   0.0331668|
|D03|	58462|	0|	1553	|   0.0265643|
|S21|	58462|	0|	30528|   	0.522185|
|D08|	58462|	0|	5872	|   0.100441|
|D19|	58462|	0|	10948|   	0.187267|
|D13|	58462|	0|	286	 |      0.00489207|
|D29|	58462|	0|	644	 |      0.0110157|
|D56|	58462|	0|	2628	|   0.0449523|
|D01|	58462|	0|	400	 |      0.00684205|
|D14|	58462|	0|	662	 |      0.0113236|
|S53|	58462|	0|	3098	|   0.0529917|
|D70|	58462|	0|	12215|   	0.208939|
|D20|	58462|	0|	1216	|   0.0207998|
|D52|	58462|	0|	2338	|   0.0399918|
|D58|	58462|	0|	477	 |      0.00815915|
|S03|	58462|	0|	0	   |    0|
|D68|	58462|	0|	519	 |      0.00887756|
|S86|	58462|	0|	16447|   	0.281328|
|S20|	58462|	0|	18149|   	0.310441|
|D60|	58462|	0|	248	 |      0.00424207|
|D64|	58462|	0|	2791	|   0.0477404|
|D62|	58462|	0|	710	 |      0.0121446|
|D74|	58462|	0|	338	 |      0.00578153|
|D78|	58462|	0|	1849	|   0.0316274|
|D80|	58462|	0|	1817	|   0.03108|

# 10x
    vcftools --vcf brevolium_snps_biallelic_mac3_miss50_10x.recode.vcf  --out brevolium_snps_biallelic_mac3_miss50_10x --missing-indv

cat brevolium_snps_biallelic_mac3_miss50_10x.imiss 

|INDV|	N_DATA|	N_GENOTYPES_FILTERED|	N_MISS|	F_MISS|
|S90|	23123|  0|	216	|    0.00934135|
|S80|	23123|	0|	1126|	0.0486961|
|S71|	23123|	0|	142	|    0.00614107|
|S65|	23123|	0|	100	|    0.0043247|
|S62|	23123|	0|	152	|    0.00657354|
|S87|	23123|	0|	339	|    0.0146607|
|S56|	23123|	0|	167	|    0.00722225|
|S52|	23123|	0|	126	|    0.00544912|
|S35|	23123|	0|	3049|	0.13186|
|S40|	23123|	0|	336	|    0.014531|
|S25|	23123|	0|	2204|	0.0953164|
|S19|	23123|	0|	252	|    0.0108982|
|S14|	23123|	0|	7001|	0.302772|
|S13|	23123|	0|	144	|    0.00622757|
|S12|	23123|	0|	57	 |   0.00246508|
|S89|	23123|	0|	71	 |   0.00307054|
|S22|	23123|	0|	333	|    0.0144012|
|S07|	23123|	0|	286	|    0.0123686|
|D24|	23123|	0|	2276|	0.0984301|
|D38|	23123|	0|	198	|    0.0085629|
|D87|	23123|	0|	72	 |   0.00311378|
|D18|	23123|	0|	66	 |   0.0028543|
|S75|	23123|	0|	133	|    0.00575185|
|D03|	23123|	0|	100	|    0.0043247|
|S21|	23123|	0|	7502|	0.324439|
|D08|	23123|	0|	559	|    0.0241751|
|D19|	23123|	0|	1427|	0.0617134|
|D13|	23123|	0|	34	 |   0.0014704|
|D29|	23123|	0|	51	 |   0.0022056|
|D56|	23123|	0|	129	|    0.00557886|
|D01|	23123|	0|	26	 |   0.00112442|
|D14|	23123|	0|	63	 |   0.00272456|
|S53|	23123|	0|	159	|    0.00687627|
|D70|	23123|	0|	1714|	0.0741253|
|D20|	23123|	0|	65	 |   0.00281105|
|D52|	23123|	0|	137	|    0.00592484|
|D58|	23123|	0|	35	 |   0.00151364|
|S03|	23123|	0|	0	  |  0|
|D68|	23123|	0|	43	 |   0.00185962|
|S86|	23123|	0|	2406|	0.104052|
|S20|	23123|	0|	2969|	0.1284|
|D60|	23123|	0|	27	 |   0.00116767|
|D64|	23123|	0|	211	|    0.00912511|
|D62|	23123|	0|	55	 |   0.00237858|
|D74|	23123|	0|	38	 |   0.00164339|
|D78|	23123|	0|	105	|    0.00454093|
|D80|	23123|	0|	199	|    0.00860615|


# 15x
    vcftools --vcf brevolium_snps_biallelic_mac3_miss50_15x.recode.vcf  --out brevolium_snps_biallelic_mac3_miss50_15x --missing-indv

cat brevolium_snps_biallelic_mac3_miss50_15x.imiss 

|INDV|	N_DATA|	N_GENOTYPES_FILTERED|	N_MISS|	F_MISS|
|S90|	13240|	0|	42	|   0.00317221|
|S80|	13240|	0|	233|   	0.0175982|
|S71|	13240|	0|	38	|   0.00287009|
|S65|	13240|	0|	28	|   0.0021148|
|S62|	13240|	0|	29	|   0.00219033|
|S87|	13240|	0|	42	|   0.00317221|
|S56|	13240|	0|	34	|   0.00256798|
|S52|	13240|	0|	24	|   0.00181269|
|S35|	13240|	0|	686|   	0.0518127|
|S40|	13240|	0|	74	|   0.00558912|
|S25|	13240|	0|	535|   	0.0404079|
|S19|	13240|	0|	43	|   0.00324773|
|S14|	13240|	0|	2412 |	0.182175|
|S13|	13240|	0|	34	|   0.00256798|
|S12|	13240|	0|	9	|   0.000679758|
|S89|	13240|	0|	22	|   0.00166163|
|S22|	13240|	0|	61	|   0.00460725|
|S07|	13240|	0|	41	|   0.00309668|
|D24|	13240|	0|	528|   	0.0398792|
|D38|	13240|	0|	91	|   0.00687311|
|D87|	13240|	0|	25	|   0.00188822|
|D18|	13240|	0|	14	|   0.0010574|
|S75|	13240|	0|	22	|   0.00166163|
|D03|	13240|	0|	14	|   0.0010574|
|S21|	13240|	0|	2763 |	0.208686|
|D08|	13240|	0|	99	|   0.00747734|
|D19|	13240|	0|	335|   	0.0253021|
|D13|	13240|	0|	10	|   0.000755287|
|D29|	13240|	0|	6	|   0.000453172|
|D56|	13240|	0|	12	|   0.000906344|
|D01|	13240|	0|	5	|   0.000377644|
|D14|	13240|	0|	12	|   0.000906344|
|S53|	13240|	0|	28	|   0.0021148|
|D70|	13240|	0|	454|   	0.03429|
|D20|	13240|	0|	13	|   0.000981873|
|D52|	13240|	0|	31	|   0.00234139|
|D58|	13240|	0|	7	|   0.000528701|
|S03|	13240|	0|	0	|   0|
|D68|	13240|	0|	17	|   0.00128399|
|S86|	13240|	0|	575|   	0.043429|
|S20|	13240|	0|	707|   	0.0533988|
|D60|	13240|	0|	7	|   0.000528701|
|D64|	13240|	0|	36	|   0.00271903|
|D62|	13240|	0|	5	|   0.000377644|
|D74|	13240|	0|	11	|   0.000830816|
|D78|	13240|	0|	19	|   0.00143505|
|D80|	13240|	0|	39	|   0.00294562|



# 20x
    vcftools --vcf brevolium_snps_biallelic_mac3_miss50_20x.recode.vcf  --out brevolium_snps_biallelic_mac3_miss50_20x --missing-indv

cat brevolium_snps_biallelic_mac3_miss50_20x.imiss 

|INDV|	N_DATA|	N_GENOTYPES_FILTERED|	N_MISS|	F_MISS|
|S90|	9134|	0|	11|   	0.00120429|
|S80|	9134|	0|	62|   	0.00678783|
|S71|	9134|	0|	21|   	0.0022991|
|S65|	9134|	0|	14|   	0.00153273|
|S62|	9134|	0|	16|   	0.0017517|
|S87|	9134|	0|	7	|   0.000766367|
|S56|	9134|	0|	12|   	0.00131377|
|S52|	9134|	0|	11|   	0.00120429|
|S35|	9134|	0|	215	|   0.0235384|
|S40|	9134|	0|	25|   	0.00273703|
|S25|	9134|	0|	195 |	0.0213488|
|S19|	9134|	0|	14|   	0.00153273|
|S14|	9134|	0|	1134 |	0.124152|
|S13|	9134|	0|	6	|   0.000656886|
|S12|	9134|	0|	7	|   0.000766367|
|S89|	9134|	0|	15|   	0.00164222|
|S22|	9134|	0|	20|   	0.00218962|
|S07|	9134|	0|	10|   	0.00109481|
|D24|	9134|	0|	170 |	0.0186118|
|D38|	9134|	0|	58|   	0.0063499|
|D87|	9134|	0|	18|   	0.00197066|
|D18|	9134|	0|	4	|   0.000437924|
|S75|	9134|	0|	13|   	0.00142325|
|D03|	9134|	0|	4	|   0.000437924|
|S21|	9134|	0|	1281 |	0.140245|
|D08|	9134|	0|	26|   	0.00284651|
|D19|	9134|	0|	136 |	0.0148894|
|D13|	9134|	0|	5	|   0.000547405|
|D29|	9134|	0|	2	|   0.000218962|
|D56|	9134|	0|	6	|   0.000656886|
|D01|	9134|	0|	3	|   0.000328443|
|D14|	9134|	0|	3	|   0.000328443|
|S53|	9134|	0|	11|   	0.00120429|
|D70|	9134|	0|	200 |	0.0218962|
|D20|	9134|	0|	6	|   0.000656886|
|D52|	9134|	0|	16|   	0.0017517|
|D58|	9134|	0|	4	|   0.000437924|
|S03|	9134|	0|	0	|   0|
|D68|	9134|	0|	12|   	0.00131377|
|S86|	9134|	0|	197 |	0.0215678|
|S20|	9134|	0|	260 |	0.0284651|
|D60|	9134|	0|	3	|   0.000328443|
|D64|	9134|	0|	14|   	0.00153273|
|D62|	9134|	0|	1	|   0.000109481|
|D74|	9134|	0|	8	|   0.000875848|
|D78|	9134|	0|	5	|   0.000547405|
|D80|	9134|	0|	14|   	0.00153273|


# 25x
    vcftools --vcf brevolium_snps_biallelic_mac3_miss50_25x.recode.vcf  --out brevolium_snps_biallelic_mac3_miss50_25x --missing-indv

cat brevolium_snps_biallelic_mac3_miss50_25x.imiss 

|INDV|	N_DATA|	N_GENOTYPES_FILTERED|	N_MISS|	F_MISS|
|S90|	6743|	0|	5	|  0.00074151|
|S80|	6743|	0|	20|  	0.00296604|
|S71|	6743|	0|	14|  	0.00207623|
|S65|	6743|	0|	5	|  0.00074151|
|S62|	6743|	0|	6	|  0.000889812|
|S87|	6743|	0|	4	|  0.000593208|
|S56|	6743|	0|	6	|  0.000889812|
|S52|	6743|	0|	8	|  0.00118642|
|S35|	6743|	0|	53|  	0.00786|
|S40|	6743|	0|	12|  	0.00177962|
|S25|	6743|	0|	75|  	0.0111226|
|S19|	6743|	0|	5	|  0.00074151|
|S14|	6743|	0|	571 |	0.0846804|
|S13|	6743|	0|	2	|  0.000296604|
|S12|	6743|	0|	4	|  0.000593208|
|S89|	6743|	0|	8	|  0.00118642|
|S22|	6743|	0|	6	|  0.000889812|
|S07|	6743|	0|	0	|  0|
|D24|	6743|	0|	59|  	0.00874981|
|D38|	6743|	0|	48|  	0.00711849|
|D87|	6743|	0|	8	|  0.00118642|
|D18|	6743|	0|	1	|  0.000148302|
|S75|	6743|	0|	9	|  0.00133472|
|D03|	6743|	0|	2	|  0.000296604|
|S21|	6743|	0|	612 |	0.0907608|
|D08|	6743|	0|	3	|  0.000444906|
|D19|	6743|	0|	53|  	0.00786|
|D13|	6743|	0|	4	|  0.000593208|
|D29|	6743|	0|	0	|  0|
|D56|	6743|	0|	2	|  0.000296604|
|D01|	6743|	0|	3	|  0.000444906|
|D14|	6743|	0|	3	|  0.000444906|
|S53|	6743|	0|	4	|  0.000593208|
|D70|	6743|	0|	99|  	0.0146819|
|D20|	6743|	0|	6	|  0.000889812|
|D52|	6743|	0|	10|  	0.00148302|
|D58|	6743|	0|	4	|  0.000593208|
|S03|	6743|	0|	0	|  0|
|D68|	6743|	0|	9	|  0.00133472|
|S86|	6743|	0|	79|  	0.0117159|
|S20|	6743|	0|	104 |	0.0154234|
|D60|	6743|	0|	3	|  0.000444906|
|D64|	6743|	0|	5	|  0.00074151|
|D62|	6743|	0|	1	|  0.000148302|
|D74|	6743|	0|	5	|  0.00074151|
|D78|	6743|	0|	0	|  0|
|D80|	6743|	0|	5	|  0.00074151|


# 30x
    vcftools --vcf brevolium_snps_biallelic_mac3_miss50_30x.recode.vcf  --out brevolium_snps_biallelic_mac3_miss50_30x --missing-indv

cat brevolium_snps_biallelic_mac3_miss50_30x.imiss 

|INDV|	N_DATA|	N_GENOTYPES_FILTERED|	N_MISS|	F_MISS|
|S90|	5330|	0|	4	|  0.000750469|
|S80|	5330|	0|	9	|  0.00168856|
|S71|	5330|	0|	10|  	0.00187617|
|S65|	5330|	0|	4	|  0.000750469|
|S62|	5330|	0|	1	|  0.000187617|
|S87|	5330|	0|	3	|  0.000562852|
|S56|	5330|	0|	6	|  0.0011257|
|S52|	5330|	0|	5	|  0.000938086|
|S35|	5330|	0|	12|  	0.00225141|
|S40|	5330|	0|	11|  	0.00206379|
|S25|	5330|	0|	36|  	0.00675422|
|S19|	5330|	0|	1	|  0.000187617|
|S14|	5330|	0|	309 |	0.0579737|
|S13|	5330|	0|	1	|  0.000187617|
|S12|	5330|	0|	1	|  0.000187617|
|S89|	5330|	0|	5	|  0.000938086|
|S22|	5330|	0|	5	|  0.000938086|
|S07|	5330|	0|	0	|  0|
|D24|	5330|	0|	17|  	0.00318949|
|D38|	5330|	0|	35|  	0.0065666|
|D87|	5330|	0|	8	|  0.00150094|
|D18|	5330|	0|	0	|  0|
|S75|	5330|	0|	6	|  0.0011257|
|D03|	5330|	0|	2	|  0.000375235|
|S21|	5330|	0|	356 |	0.0667917|
|D08|	5330|	0|	1	|  0.000187617|
|D19|	5330|	0|	29|  	0.0054409|
|D13|	5330|	0|	1	|  0.000187617|
|D29|	5330|	0|	0	|  0|
|D56|	5330|	0|	2	|  0.000375235|
|D01|	5330|	0|	1	|  0.000187617|
|D14|	5330|	0|	2	|  0.000375235|
|S53|	5330|	0|	3	|  0.000562852|
|D70|	5330|	0|	56|  	0.0105066|
|D20|	5330|	0|	3	|  0.000562852|
|D52|	5330|	0|	7	|  0.00131332|
|D58|	5330|	0|	4	|  0.000750469|
|S03|	5330|	0|	0	|  0|
|D68|	5330|	0|	9	|  0.00168856|
|S86|	5330|	0|	43|  	0.00806754|
|S20|	5330|	0|	50|  	0.00938086|
|D60|	5330|	0|	1	|  0.000187617|
|D64|	5330|	0|	2	|  0.000375235|
|D62|	5330|	0|	0	|  0|
|D74|	5330|	0|	3	|  0.000562852|
|D78|	5330|	0|	0	|  0|
|D80|	5330|	0|	1	|  0.000187617|

